name = "brunoyang-site"
main = ".open-next/worker.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# 自定义域名配置
[[routes]]
pattern = "bruno-yang.com"
custom_domain = true

[[routes]]
pattern = "www.bruno-yang.com"
custom_domain = true

[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# R2 存储桶配置（用于增量缓存）
[[r2_buckets]]
binding = "NEXT_INC_CACHE_R2_BUCKET"
bucket_name = "store"

# D1 数据库配置
[[d1_databases]]
binding = "DB"
database_name = "brunoyang-site-db"
database_id = "b9f6c4dc-77a4-4ee1-bbb3-5bf9b4d8810d"

# KV 键值存储（文章阅读量 + AI 摘要缓存）
[[kv_namespaces]]
binding = "KV"
id = "e1044732b23d48e69cf4fc5b3c381b76"

# Workers AI
[ai]
binding = "AI"

# Queues（联系表单异步通知）
[[queues.producers]]
queue = "contact-notifications"
binding = "CONTACT_QUEUE"

# Analytics Engine（自定义事件分析）
[[analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "site_events"
